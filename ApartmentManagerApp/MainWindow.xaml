<Window x:Class="ApartmentManagementApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sistem za Upravljanje Apartmanima" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Global Styles -->
        <Style TargetType="Button">
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <Style TargetType="Label">
            <Setter Property="Margin" Value="5"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="Margin" Value="10"/>
        </Style>
    </Window.Resources>

    <TabControl>
        <!-- GOSTI TAB -->
        <TabItem Header="Gosti">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid Grid.Row="0" ItemsSource="{Binding Guests}" SelectedItem="{Binding SelectedGuest}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding GuestId}" Width="50"/>
                        <DataGridTextColumn Header="Ime" Binding="{Binding FirstName}" Width="*"/>
                        <DataGridTextColumn Header="Prezime" Binding="{Binding LastName}" Width="*"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*"/>
                        <DataGridTextColumn Header="Telefon" Binding="{Binding PhoneNumber}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="1" Margin="10">
                    <TextBlock Text="Forma za Goste" FontWeight="Bold" Margin="5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="Ime:"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding GuestFirstName, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="0" Grid.Column="2" Content="Prezime:"/>
                        <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding GuestLastName, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="Email:"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding GuestEmail, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="1" Grid.Column="2" Content="Telefon:"/>
                        <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding GuestPhone, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Dodaj Gosta" Command="{Binding AddGuestCommand}"/>
                        <Button Content="Izmeni Gosta" Command="{Binding UpdateGuestCommand}"/>
                        <Button Content="Obriši Gosta" Command="{Binding DeleteGuestCommand}" Background="#F44336"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </TabItem>

        <!-- APARTMANI TAB -->
        <TabItem Header="Apartmani">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid Grid.Row="0" ItemsSource="{Binding Apartments}" SelectedItem="{Binding SelectedApartment}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding ApartmentId}" Width="50"/>
                        <DataGridTextColumn Header="Naziv" Binding="{Binding Name}" Width="*"/>
                        <DataGridTextColumn Header="Kapacitet" Binding="{Binding Capacity}" Width="80"/>
                        <DataGridTextColumn Header="Lokacija" Binding="{Binding Location}" Width="*"/>
                        <DataGridTextColumn Header="Cena/Noć" Binding="{Binding PricePerNight, StringFormat={}{0:N0} RSD}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="1" Margin="10">
                    <TextBlock Text="Forma za Apartmane" FontWeight="Bold" Margin="5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="Naziv:"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ApartmentName, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="0" Grid.Column="2" Content="Kapacitet:"/>
                        <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding ApartmentCapacity, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="Lokacija:"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ApartmentLocation, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="1" Grid.Column="2" Content="Cena po Noći:"/>
                        <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding ApartmentPrice, UpdateSourceTrigger=PropertyChanged}"/>

                        <Label Grid.Row="2" Grid.Column="0" Content="Opis:"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" Text="{Binding ApartmentDescription, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Dodaj Apartman" Command="{Binding AddApartmentCommand}"/>
                        <Button Content="Izmeni Apartman" Command="{Binding UpdateApartmentCommand}"/>
                        <Button Content="Obriši Apartman" Command="{Binding DeleteApartmentCommand}" Background="#F44336"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </TabItem>

        <!-- REZERVACIJE TAB -->
        <TabItem Header="Rezervacije">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- PANEL ZA PRETRAGU -->
                <GroupBox Grid.Row="0" Header="Pretraga Rezervacija" Margin="10">
                    <StackPanel>
                        <TextBlock Text="Ostavite polja prazna da prikažete sve rezervacije" FontStyle="Italic" Margin="5" Foreground="Gray"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Label Grid.Column="0" Content="ID Gosta:"/>
                            <TextBox Grid.Column="1" Text="{Binding SearchGuestId, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

                            <Label Grid.Column="2" Content="ID Apartmana:"/>
                            <TextBox Grid.Column="3" Text="{Binding SearchApartmentId, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

                            <Label Grid.Column="4" Content="Datum:"/>
                            <DatePicker Grid.Column="5" SelectedDate="{Binding SearchDate, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

                            <Button Grid.Column="6" Content="Pretraži" Command="{Binding SearchReservationsCommand}" Background="#4CAF50"/>
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <DataGrid Grid.Row="1" ItemsSource="{Binding Reservations}" SelectedItem="{Binding SelectedReservation}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding ReservationId}" Width="50"/>
                        <DataGridTextColumn Header="Gost" Binding="{Binding Guest.FirstName}" Width="*"/>
                        <DataGridTextColumn Header="Apartman" Binding="{Binding Apartment.Name}" Width="*"/>
                        <DataGridTextColumn Header="Prijava" Binding="{Binding CheckInDate, StringFormat=d}" Width="100"/>
                        <DataGridTextColumn Header="Odjava" Binding="{Binding CheckOutDate, StringFormat=d}" Width="100"/>
                        <DataGridTextColumn Header="Ukupna Cena" Binding="{Binding TotalPrice, StringFormat={}{0:N0} RSD}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="2" Margin="10">
                    <TextBlock Text="Kreiranje Rezervacije" FontWeight="Bold" Margin="5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="Gost:"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" ItemsSource="{Binding Guests}" 
                                  SelectedItem="{Binding SelectedGuest}" DisplayMemberPath="FirstName" Margin="5"/>

                        <Label Grid.Row="0" Grid.Column="2" Content="Apartman:"/>
                        <ComboBox Grid.Row="0" Grid.Column="3" ItemsSource="{Binding Apartments}" 
                                  SelectedItem="{Binding SelectedApartment}" DisplayMemberPath="Name" Margin="5"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="Datum Prijave:"/>
                        <DatePicker Grid.Row="1" Grid.Column="1" SelectedDate="{Binding CheckInDate}" Margin="5"/>

                        <Label Grid.Row="1" Grid.Column="2" Content="Datum Odjave:"/>
                        <DatePicker Grid.Row="1" Grid.Column="3" SelectedDate="{Binding CheckOutDate}" Margin="5"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Kreiraj Rezervaciju" Command="{Binding CreateReservationCommand}" Background="#4CAF50"/>
                        <Button Content="Obriši Rezervaciju" Command="{Binding DeleteReservationCommand}" Background="#F44336"/>
                        <Button Content="Osveži Sve" Command="{Binding LoadDataCommand}"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </TabItem>
    </TabControl>
</Window>